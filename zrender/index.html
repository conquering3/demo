<!DOCTYPE html>
<html lang="zh_cn">
<head>
    <meta charset="UTF-8">
    <title>zrender</title>
    <style>
        .container {
            width: 500px;
            height: 500px;
            border: 1px solid #ccc;
        }
        .test {
            display: inline-block;
            border: 1px solid #f00;
        }
    </style>
</head>
    <body>
    <div class="container">
    </div>
    <div class="test">
        <canvas id="test" width="400" height="400"></canvas>
    </div>
    <script src="./zrender.min.js"></script>
    <script>
        demo2('test')
        function demo2 (id) {
            var canvas = document.getElementById(id);
    　　    var context = canvas.getContext("2d");
        　　    
            // 1排1----默认填充为黑色 fillStyle = "#000"
            context.fillRect(20, 20, 60, 60);
        // 1排2----默认边框为黑色 strokeStyle = "#000"    
            context.strokeRect(100, 20, 60, 60);
            
            // 2排----自定义填充色和边框颜色
            context.fillStyle = "#0000ff";
            context.strokeStyle = "#ff0000";
            
            context.fillRect(20, 100, 60, 60);    //蓝色填充矩形
            
            context.strokeRect(100, 100, 60, 60);    //红色边框矩形
            
            context.lineWidth = 10;        //设置边框线框
            context.strokeRect(180, 100, 60, 60);    //加粗边框矩形
            
            // 3排----清除20*20的矩形区域
            context.fillStyle = "#00ff00";
            
            context.fillRect(20, 180, 60, 60);
            context.clearRect(30, 190, 20, 20);        
            
            // 4排----给矩形添加透明度
            context.fillStyle = "rgba(0,255,0,0.2)";
            context.strokeStyle = "rgba(0,255,0,0.2)";
            
            context.fillRect(20, 260, 60, 60);        //变浅的红色填充矩形
            
            context.lineWidth = 10;        //设置边框线框，0.2的透明度不易观察
            context.strokeRect(100, 260, 60, 60);    //变浅的红色边框矩形

            context.fillStyle = '#ff0';
            context.fillRect(180, 300, 60, 60);

            context.beginPath();
            context.scale(.5, .5);
            context.strokeStyle = '#0f0';
            context.fillStyle = "rgba(0,255,0,0.2)";
            context.rect(200, 300, 50, 50);
            context.stroke();
            context.closePath();

            context.beginPath();
            context.scale(2, 2);
            context.strokeStyle = '#00f';
            context.fillStyle = "rgba(0,255,0,0.2)";
            context.rect(240, 300, 50, 50);
            context.stroke();
            context.closePath();

            context.beginPath();
            context.lineWidth = 1;
            context.font = '12px yahei';
            context.strokeStyle = "#f0f";
            context.strokeText('Hello World', 250, 50);
            context.closePath();

         }
    </script>
    <script>
        (function (zrender) {
            var zr = zrender.init(document.querySelector('.container')),
                group = new zrender.Group(),
                cxt;
            
            // zr.add(group);
            var rect = new zrender.Circle({
                shape: {
                    x: -250,
                    y: -250,
                    width: 1000,
                    height: 1000
                }
            });
            // zr.add(rect);
            var zcircle = new zrender.Circle({
                shape: {
                    cx: 250,
                    cy: 250,
                    r: 100
                },
                draggable: true,
                style: {
                    fill: 'transparent',
                    stroke: '#f00'
                }
            });
            var zcircle1 = new zrender.Circle({
                shape: {
                    cx: 100,
                    cy: 100,
                    r: 50
                },
                draggable: true,
                style: {
                    fill: 'transparent',
                    stroke: '#f00'
                }
            });
            var zdot = new zrender.Circle({
                shape: {
                    cx: 150,
                    cy: 250,
                    r: 10
                }
            });
            // zr.add(zcircle);
            // zr.add(zdot);
            zr.add(zcircle1);
            /**
             * @params area: 象线 0, 1, 2, 3 从左逆时针数
             * @params direction: 方向 0 逆时针 1 顺时针
             * @params cx、cy、r 圆坐标、半径
             * @params startX、startY 初始坐标
             * @description 每条移动一个px
             */
            var createNextPoint = function (cx, cy, r, startX, startY, direction) {
                var area,
                    upY = r - cy,
                    downY = r + cy,
                    px = 4,
                    nextX,
                    nextY;
                area = (cx > startX)
                        ?(cy >= startY? 0: 3)
                        :(cy >= startY? 1: 2);
                console.log('area:', area);
                if (area === 0 || area === 3) {
                    if (direction) {
                        if (startY + px > downY) {
                            nextY = startY - px;
                            nextX = cx + getX(r, Math.abs(cy - nextY));
                        }
                        else {
                            nextY = startY + px;
                            nextX = cx - getX(r, Math.abs(cy - nextY));
                        }
                    }
                    else {
                        if (startY - px < upY) {
                            nextY = startY + px;
                            nextX = cx + getX(r, Math.abs(cy - nextY));
                        }
                        else {
                            nextY = startY - px;
                            nextX = cx - getX(r, Math.abs(cy - nextY));
                        }
                    }

                }
                else if (area === 1 || area === 2) {
                    if (direction) {
                        if (statrY - px < upY) {
                            nextY = startY + px;
                            nextX = cx - getX(r, Math.abs(cy - nextY));
                        }
                        else {
                            nextY = startY - px;
                            nextX = cx + getX(r, Math.abs(cy - nextY));
                        }
                    }
                    else {
                        if (startY + px > downY) {
                            nextY = startY - px;
                            nextX = cx - getX(r, Math.abs(cy - nextY));
                        }
                        else {
                            nextY = startY + px;
                            nextX = cx + getX(r, Math.abs(cy - nextY));
                        }
                    }
                }
                return {
                    cx: nextX,
                    cy: nextY
                }
            };
            // 平方跟 X*X + Y*Y = R*R 获取X距离R的长度
            var getX = function (R, Y) {
                return Math.sqrt(Math.pow(R, 2) - Math.pow(Y, 2));
            };
            var zAnimate = zdot.animate('shape', true);
            var nextX = 150,
                nextY = 250;
            for (var i = 0; i < 100; i++) {
                var obj = createNextPoint(250, 250, 100, nextX, nextY, 0);
                nextX = obj.cx;
                nextY = obj.cy;
                zAnimate.when(50*i, obj);
            }
            // zAnimate.start();

            // BezierCurve
            var bezierCurve = new zrender.BezierCurve({
                shape: {
                    x1: 0,
                    y1: 0,
                    x2: 500,
                    y2: 500,
                    cpx1: 200,
                    cpy1: 300,
                    cpx2: 300,
                    cpy2: 50,
                    percent: 0
                }
            });
            // zr.add(bezierCurve);
            // group.add(bezierCurve);
            // group.add(zcircle);
            // bAnimate = bezierCurve.animate('share', true);
            bezierCurve.animateTo({shape: {percent: 1}}, 5000, 0, 'ease-out-in', null, true);
            var i = 0;
                scale = [1, 1];
            // text 
            var t1 = new zrender.Text({
                    style: {
                        text: 'zrender',
                        textAlign: 'center',
                        textLineWidth: 2,
                        textStroke: '#0f0',
                        // textVerticalAlign: 'middle',
                        font: '20px yahei',
                        fontSize: 20,
                        textWidth: 40,
                        textHeight: 50,
                        // textBackgroundColor: '#0f0',
                        // fontFamily: 'Lato',
                        // fontWeight: 'bolder',
                        // textFill: '#0ff',
                       //  blend: 'lighten'
                    },
                    position: [100, 100]
                });
                zr.add(t1);
            zcircle1.attr({
                position: [50, 50]
            })
            zr.on('mousewheel', function (ze) {
                console.log(this);
                ze.event.preventDefault();
                // console.log(ze);
                if (ze.wheelDelta > 0) {
                    console.log('+');
                    scale = [scale[0] + 0.2 > 2? 2: scale[0] + 0.2, scale[0] + 0.2 > 2? 2: scale[0] + 0.2]
                    // zcircle1.origin = [ze.offsetX, ze.offsetY];
                }
                else {
                    console.log('-');
                    scale = [scale[0] - 0.2 < 0.2? 0.2: scale[0] - 0.2, scale[0] - 0.2 < 0.2? 0.2: scale[0] - 0.2]
                }
                // console.log(scale);
                zcircle1.origin = [ze.offsetX, ze.offsetY];
                zcircle.origin = [ze.offsetX, ze.offsetY];
                bezierCurve.origin = [ze.offsetX, ze.offsetY];
                rect.origin = [ze.offsetX, ze.offsetY];
                /* zcircle1.origin = [250, 250];
                zcircle.origin = [250, 250];
                bezierCurve.origin = [250, 250];
                rect.origin = [250, 250]; */
                

                zcircle1.scale = scale;
                zcircle.scale = scale;
                bezierCurve.scale = scale;
                rect.scale = scale;

                zcircle1.attr();

                // group.add(bezierCurve);
                // zr.add(zcircle1);
                // zr.add(zcircle);
               //  zr.add(rect);
                // zr.add(bezierCurve);
                t1.attr({
                    scale: scale,
                    origin: [ze.offsetX, ze.offsetY]
                });
            });
            zr.on('mousedown', function (ze) {
                console.log('down');
            });
            zr.on('mousemove', function (ze) {
                console.log('move');
            });
            zr.on('mouseup', function (ze) {
                console.log('up');
            });
        })(zrender);
    </script>
    </body>
</html>